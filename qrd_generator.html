<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script src="https://code.jquery.com/jquery-1.12.3.min.js"  type="text/javascript"></script>
<!-- <link rel="stylesheet" href=".css"> -->
</head>
<body>
<div>
URL of your data relative to the q.rd: <input id="m_Data_Source"></input><br />
<i>e.g.: data/fp05-good.csv</i><br /><br />
Describe your table: <input id="m_Service_Description"></input><br />
<i>e.g.: EPN-TAP access to the Test CRISM database.</i>
<h1>Metadata for the resource:</h1>
<table>
<tr><td>Schema name: </td><td><input id="mSchema"></input></td></tr>
<tr><td>Title: </td><td><input id="mTitle"></input></td></tr>
<tr><td>Description: </td><td><input id="mDescription"></input></td></tr>
<tr><td>Creation date: </td><td><input id="mCreationDate"></input> (e.g. 2016-03-30T00:00:00)</td></tr>
<tr><td>Subject: </td><td><input id="mSubject"></input></td></tr>
<tr><td>Creator name: </td><td><input id="mCreatorName"></input></td></tr>
<tr><td>Contact name: </td><td><input id="mContactName"></input></td></tr>
<tr><td>Contact email: </td><td><input id="mContactEmail"></input></td></tr>
<tr><td>Instrument: </td><td><input id="mInstrument"></input></td></tr>
<tr><td>Facility: </td><td><input id="mFacility"></input></td></tr>
<tr><td>Source: </td><td><input id="mSource"></input></td></tr>
<tr><td>Content level: </td><td><input id="mContentLevel"></input></td></tr>
<tr><td>Waveband (Mark all that apply)</td><td>
<input type="checkbox" id="mWbRadio">Radio<br />
<input type="checkbox" id="mWbMillimeter">Millimeter<br />
<input type="checkbox" id="mWbInfrared">Infrared<br />
<input type="checkbox" id="WbOptical">Optical<br />
<input type="checkbox" id="WbUV">UV<br />
<input type="checkbox" id="WbEUV">EUV<br />
<input type="checkbox" id="WbXRay">X-ray<br />
<input type="checkbox" id="WbGammaRay">Gamma-ray</td></tr>
<tr><td>Profile:</td><td><input id="mProfile"></input><br/></td></tr>
</table>

<h1 style="color:red">Mandatory parameters:</h1>
<p><i>This may include python expressions. <br />
To map input directly to output choose "MAP" <br />
To use expressions choose "VAR"<br />
For null values choose "NUL" 
</i></p>
<h2>1 - Granule references</h2>
<p><i>NUL values not, values required</i></p>
<table>
<tr>
<td><select id="rVM_granule_uid">
<option>MAP</option><option>VAR</option></select></td>
<td>granule_uid: </td>
<td><input id="r_granule_uid"></input></td>
</tr>
<tr>
<td><select id="rVM_granule_gid">
<option>MAP</option><option>VAR</option></select></td>
<td>granule_gid: </td>
<td><input id="r_granule_gid"></input></td>
</tr>
<tr>
<td><select id="rVM_obs_id">
<option>MAP</option><option>VAR</option></select></td>
<td>obs_id: </td>
<td><input id="r_obs_id"></input></td>
</tr>
</table>



<h2>2 - Data description</h2>
<table>
<tr>
<td><select id="rVM_dataproduct_type">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>DataProduct Type: </td>
<td><input id="r_dataproduct_type"></input></td>
</tr>
<tr>
<td><select id="rVM_measurement_type">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>Measurement Type: </td>
<td><input id="r_measurement_type"></input></td>
</tr>
<tr><td><br /></td></tr>
<tr>
<td>
<select id="rVM_processing_level">
<!--
<option>NUL</option><option>MAP</option>
-->
<option>VAR</option></select></td>
<td>Processing Level: </td>
<td>
<select id="r_processing_level">
<option title="Unprocessed Data Record" value ="1">1 - Unprocessed</option>
<option title="Experiment Data Record"  value ="2">2 - Experiment</option>
<option title="Reduced Data Record"     value ="3">3 - Reduced</option>
<option title="Reformatted Data Record" value ="4">4 - Reformatted</option>
<option title="Derived Data Record"     value ="5">5 - Derived</option>
<option title="Ancillary Data Record"   value ="6">6 - Ancillary</option>
</select>
<i> * This field is mandatory.</i></td>
</tr>
<tr>
</table>
<h2>3 - Target descripion</h2>
<table>
<tr>
<td><select id="rVM_target_name">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>Target Name: </td>
<td><input id="r_target_name"></input></td>
</tr>
<tr>
<td><select id="rVM_target_class">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>Target Class: </td>
<td><input id="r_target_class"></input></td>
</tr>
</table>
<h2>4 - Axes</h2>
<table>
<tr>
<td><select id="rVM_time_min">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>Time Range Min: </td>
<td><input id="r_time_min"></input><i> * in Julian days</i></td>
</tr>
<tr>
<td><select id="rVM_time_max">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>Time Range Max: </td>
<td><input id="r_time_max"></input></td>
</tr>
<tr>
<td><select id="rVM_time_sampling_step">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>Time Sampling Step: </td>
<td><input id="r_time_sampling_step"></input></td>
</tr>
<tr>
<td><select id="rVM_time_exp">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>time_exp: </td>
<td><input id="r_time_exp"></input></td>
</tr>
<tr><td><br /></td></tr>
<tr>
<td><select id="rVM_spectral_range_min">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>Spectral Range (minimum): </td>
<td><input id="r_spectral_range_min"></td>
</tr>
<td><select id="rVM_spectral_range_max">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>Spectral Range (maximum): </td>
<td><input id="r_spectral_range_max"></td>
</tr>
<tr>
<td><select id="rVM_spectral_sampling_step">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>Spectral Sampling Step: </td>
<td><input id="r_spectral_sampling_step"></input></td>
</tr>
<tr>
<td><select id="rVM_spectral_resolution">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>Spectral Resolution: </td>
<td><input id="r_spectral_resolution"></input></td>
</tr>
<tr><td colspan="2"><p><b>Spatial Coordinates:</b></p></td></tr>
<tr>
<td><select id="rVM_c1min">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>C1 minimum: </td>
<td><input id="r_c1min"></input></td>
</tr>
<tr>
<td><select id="rVM_c1max">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>C1 maximum: </td>
<td><input id="r_c1max"></input></td>
</tr>
<tr>
<td><select id="rVM_c1_resol_min">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>C1 Spatial Resolution minimum: </td>
<td><input id="r_c1_resol_min"></input></td>
</tr>
<tr>
<td><select id="rVM_c1_resol_max">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>C1 Spatial Resolution maximum: </td>
<td><input id="r_c1_resol_max"></input></td>
</tr>
<tr><td><br /></td></tr>
<tr>
<td><select id="rVM_c2min">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>C2 minimum: </td>
<td><input id="r_c2min"></input></td>
</tr>
<tr>
<td><select id="rVM_c2max">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>C2 maximum: </td>
<td><input id="r_c2max"></input></td>
</tr>
<tr>
<td><select id="rVM_c2_resol_min">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>C2 Spatial Resolution minimum: </td>
<td><input id="r_c2_resol_min"></input></td>
</tr>
<tr>
<td><select id="rVM_c2_resol_max">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>C2 Spatial Resolution maximum: </td>
<td><input id="r_c2_resol_max"></input></td>
</tr>
<tr><td><br /></td></tr>
<tr>
<td><select id="rVM_c3min">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>C3 minimum: </td>
<td><input id="r_c3min"></input></td>
</tr>
<tr>
<td><select id="rVM_c3max">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>C3 maximum: </td>
<td><input id="r_c3max"></input></td>
</tr>
<tr>
<td><select id="rVM_c3_resol_min">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>C3 Spatial Resolution minimum: </td>
<td><input id="r_c3_resol_min"></input></td>
</tr>
<tr>
<td><select id="rVM_c3_resol_max">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>C3 Spatial Resolution maximum: </td>
<td><input id="r_c3_resol_max"></input></td>
</tr>
<tr><td><br /></td></tr>
<tr>
<td>
<select id="rVM_spatial_frame_type">
<!--
<option>NUL</option><option>MAP</option>
-->
<option>VAR</option></select>
</td>
<td>Spatial Frame Type: </td>
<td>
<select id="r_spatial_frame_type">
<option>celestial</option>
<option>body</option>
<option>cartesian</option>
<option>cylindrical</option>
<option>spherical</option>
<option>healpix</option>
</select>
<i> * This field is mandatory.</i>
</td>
</tr>
<tr><td colspan="2"><p><b>Angles:</b></p></td></tr>
<tr>
<td><select id="rVM_incidence_min">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>Incidence Angle minimum: </td>
<td><input id="r_incidence_min"></input></td>
</tr>
<tr>
<td><select id="rVM_incidence_max">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>Incidence Angle maximum: </td>
<td><input id="r_incidence_max"></input></td>
</tr>
<tr><td><br /></td></tr>
<tr>
<td><select id="rVM_emergence_min">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>Emergence Angle minimum: </td>
<td><input id="r_emergence_min"></input></td>
</tr>
<tr>
<td><select id="rVM_emergence_max">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>Emergence Angle maximum: </td>
<td><input id="r_emergence_max"></input></td>
</tr>
<tr><td><br /></td></tr>
<tr>
<td><select id="rVM_phase_min">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>Phase Angle minimum: </td>
<td><input id="r_phase_min"></input></td>
</tr>
<tr>
<td><select id="rVM_phase_max">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>Phase Angle maximum: </td>
<td><input id="r_phase_max"></input></td>
</tr>
</table>
<h2>5 - Data origin</h2>
<table>
<tr>
<td><select id="rVM_instrument_host_name">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>Instrument_Host_Name: </td>
<td><input id="r_instrument_host_name"></input></td>
</tr>
<tr>
<td><select id="rVM_instrument_name">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>Instrument_Name: </td>
<td><input id="r_instrument_name"></input></td>
</tr>
</table>
<h2>6 - Granule call-back info</h1>
<table>
<tr>
<td><select id="rVM_service_title">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>Service title: </td>
<td><input id="r_service_title"></input></td>
</tr>
<tr>
<td><select id="rVM_creation_date">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>Creation date: </td>
<td><input id="r_creation_date"></input></td>
</tr>
<tr>
<td><select id="rVM_modification_date">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>Modification date: </td>
<td><input id="r_modification_date"></input></td>
</tr>
<tr>
<td><select id="rVM_release_date">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>Release date: </td>
<td><input id="r_release_date"></input></td>
</tr>
</table>
<p />
<p />
<h1 style="color:red">Optional parameters</h1>

<h2>7 - Data Access Reference:</h2>
<table>
<tr>
<td><select id="rVM_access_url">
<option>MAP</option><option>VAR</option></select></td>
<td>access_url: </td>
<td><input id="r_access_url"></input> <i>URL of the data file, case sensitive. If present, next 2 paramenters must be present.</i></td>
</tr>
<tr>
<td><select id="rVM_access_format">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>access_format: </td>
<td><input id="r_access_format"></input></td>
</tr>
<tr>
<td><select id="rVM_access_estsize">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>access_estsize: </td>
<td><input id="r_access_estsize"></input></td>
</tr>
<tr>
<td><select id="rVM_thumbnail_url">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>thumbnail_url: </td>
<td><input id="r_thumbnail_url"></input></td>
</tr>
<tr>
<td><select id="rVM_file_name">
<option>NUL</option><option>MAP</option><option>VAR</option></select></td>
<td>file_name: </td>
<td><input id="r_file_name"></input></td>
</tr>
</table>

<p>
<button id="btnGenerate">generate q.rd</button>
</p>
<div><PRE  id="output"> javascript outputs here </PRE></div>


<script>
$(document).ready(function(e){
$("#btnGenerate").click( function(){
chr=String.fromCharCode;
cN  = chr(13);
cT = chr(9);
cTT = cT + cT;
cTTT = cTT + cT;
urResourceName = $('#mSchema').val();


var metaOpen  = function (name) {return cT + "\<meta name=\"" + name + "\"\>";}
var metaClose = "\</meta\>"  + cN;
var metaLine  = function (name, value) { return metaOpen(name) + value + metaClose;}
//BEGIN by filling out METADATA
myStr = "\<resource schema=\"" + $('#mSchema').val() + "\"\>" + cN
	+ metaLine("title",         $('#mTitle').val()        )
	+ metaLine("description",   $('#mDescription').val()  )
	+ metaLine("creationDate",  $('#mCreationDate').val() )
	+ metaLine("subject",       $('#mSubject').val()      )
	+ metaLine("creator.name",  $('#mCreatorName').val()  )
	+ metaLine("contact.name",  $('#mContactName').val()  )
	+ metaLine("contact.email", $('#mContactEmail').val() )
	+ metaLine("instrument",    $('#mInstrument').val()   )
	+ metaLine("facility",      $('#mFacility').val()     )
	+ metaLine("source",        $('#mSource').val()       )
	+ metaLine("contentLevel",  $('#mContentLevel').val() )
	+ metaLine("type",          "Catalog"                 );
// Waveband and Profile are children of Coverage, these should be computed first
// Wavebands:
var myMetaWavebands = ["band1", "band2", "band3"];
wavebands = [	["Radio",      $('#mWbRadio'      ).is(':checked')],
		["Millimeter", $('#mWbMillimeter' ).is(':checked')],
		["Infrared",   $('#mWbInfrared'   ).is(':checked')],
		["Optical",    $('#WbOptical'     ).is(':checked')],
		["UV",         $('#WbUV'          ).is(':checked')],
		["EUV",        $('#WbEUV'         ).is(':checked')],
		["X-ray",      $('#WbXRay'        ).is(':checked')],
		["Gamma-ray",  $('#WbGammaRay'    ).is(':checked')]   ];
myWavebands = [];
for (band of wavebands) { if (band[1]) {myWavebands.push(band[0])}}
var myOutWaveband = function (band) {return cTT
					+ '\<meta name=\"waveband\"\>' + band + '\<\/meta\>' + cN}
outMyMetaWavebands= "";
for (band of myWavebands) {outMyMetaWavebands += myOutWaveband(band)}
// Profile:
var myMetaProfile = $('#mProfile').val();
var myMetaProfileT = cT + metaOpen("Profile") + myMetaProfile + metaClose + cT;
var outMyMetaProfile = (myMetaProfile != "" ? myMetaProfileT : "");
myStr += metaOpen("coverage") + cN + outMyMetaWavebands + outMyMetaProfile + metaClose + cN;
// END of METADATA
myStr += '\<!-- METADATA COMPLETE --\>' + cN + cN;
// START make TABLE
var myTableID = "epn_core";
myStr += cT + '\<table id=\"' + myTableID + '\" onDisk=\"true\"\>' + cN;
// add mixin
var myProcessingLvl = $('#r_processing_level').val();
var mySpatialFrameType = $('#r_spatial_frame_type').val();
myStr += cTT + '\<mixin processing_level=\"' + myProcessingLvl
		+ '\" spatial_frame_type=\"' + mySpatialFrameType + '\"\>//epntap2#table\</mixin\>' + cN;
// make table metadata
myStr += cTT + '\<meta name=\"info\" infoName=\"SERVICE_PROTOCOL\" infoValue=\"0.3\"\>EPN-TAP\</meta\>' + cN;
var myServiceDescription = $('#m_Service_Description').val();
myStr += cTT + '\<meta name=\"description\"\>' + myServiceDescription + '\</meta\>' + cN;
// make table STC
myStr += cTT + '\<stc\>' + cN + cTTT + "Polygon ICRS [s_region]" + cN + cTT + '\</stc\>' + cN;
// make table optional columns
myStr += '\<!-- MAKE OPTIONAL COLUMNS: --\>' + cN;
//   // make access reference
/*
var procDefBind = function(name) { 
	if ($('#rVM_' + name).val() != "NUL") {
		return cTTT + cTT + '\<bind name=\"' + name + '\">@' + name + '\</bind\>' + cN;}
		else {return "";}
	}*/

if ($('#rVM_' + 'access_url').val() != "NUL") {
	myStr += cTT + '\<column name=\"access_url\" type=\"text\" ucd=\"meta.ref.url;meta.file\" verbLevel=\"1\" description=\"URL of the data file, ' 
+ cN + cTTT + 'case sensitive. If present, next 2 paramenters must be present.\"/\> ' + cN;}
if ($('#rVM_' + 'access_format').val() != "NUL") {
	myStr += cTT + '\<column name=\"access_format\" type=\"text\" ucd=\"meta.code.mime\" verbLevel=\"1\" description=\"File format type\"/\> ' + cN;}
if ($('#rVM_' + 'access_estsize').val() != "NUL") {
	myStr += cTT + '\<column name=\"access_estsize\" type=\"integer\" unit=\"kbyte\" '
                   + 'ucd=\"phys.size;meta.file\" verbLevel=\"1\" description=\"Estimate file size in kbyte (with this spelling)\"/\> ' + cN;}

if ($('#rVM_' + 'thumbnail_url').val() != "NUL") {
	myStr += cTT + '\<column name=\"thumbnail_url\" type=\"text\" '
                   + 'ucd=\"meta.ref.url;meta.preview \" verbLevel=\"1\" description=\"URL of a thumbnail image with predefined size '
                   + '(png ~200 pix, for use in a client only)\"/\> ' + cN;}
if ($('#rVM_' + 'file_name').val() != "NUL") {
	myStr += cTT + '\<column name=\"file_name\" type=\"text\" '
                   + 'ucd=\"meta.id;meta.file" verbLevel=\"1\" description=\"Name of the data file only, case sensitive\"/\> ' + cN;}

// ??? [========================] ???
// ??? [===> Place holder < ====] ???
// ??? [========================] ???
myStr += cN + '\<!-- MAKE more OPTIONAL COLUMNS, for example: --\>' + cN;
myStr += '\<!--' + cN + cTT + '\<column name=\"access_url\" type=\"text\" ucd=\"meta.ref.url;meta.file\" verbLevel=\"1\" description=\"URL of the data file, ' + cN + cTTT + 'case sensitive. If present, next 2 paramenters must be present.\"/\> ' + cN + '--\>' + cN;
// make table non-standard columns
// ??? [========================] ???
// ??? [===> Place holder < ====] ???
// ??? [========================] ???
myStr += '\<!-- MAKE NON-STANDARD COLUMNS, for example: --\>' + cN;
myStr += '\<!--' + cN + cTT + '\<column name=\"counter\" type=\"text\" ucd=\"meta.note;meta.main\" tablehead=\"value\" verbLevel=\"1\" description=\"non standard\" /\>' + cN + '--\>' + cN;
// publish
myStr += cTT + '\<publish /\>' + cN;
// close
myStr += cT + '\</table\>' + cN;
// END make TABLE
myStr += '\<!-- TABLE COMPLETE --\>' + cN + cN;
// START data import
myDataSource = $('#m_Data_Source').val();
myStr += cT + '\<data id=\"import\"\>' + cN + cTT + '\<sources\>' + myDataSource + '\</sources\>' + cN;
myStr += cTT + '\<csvGrammar\>' + cN + cTTT + '\<rowfilter procDef=\"//products#define\"\>' + cN
		+ cT + cTTT + '\<bind name=\"table\"\>\"\schema.epn_core\"\</bind\>'+ cN
			+ cTTT + '\</rowfilter\>' + cN + cTT + '\</csvGrammar\>' + cN;
// maketable & rowmaker
myStr += cTT + '\<make table=\"epn_core\"\>' + cN + cTTT + '\<rowmaker idmaps=\"*\"\>' + cN;
//START of MANDATORY PARAMS:
//in case of map

//granule_uid_type = $('#rVM_granule_uid').val()
//granule_uid = $('#r_granule_uid').val()

var makeRow = function(myType, myValue, myKey) {
	if (myType == "MAP") {
		return cTT + cTT + '\<var key=\"' + myKey +  '\" source=\"' + myValue + '\" /\>' + cN;
	}
	else if (myType == "VAR") {
		return cTT + cTT + '\<var key=\"' + myKey +  '\"\>' + myValue + '\</var\>' + cN;
	}
	else if (myType == "NUL") {
		return "";
	}
}

var makeRowStd = function(name) { return makeRow($('#rVM_' + name).val(), $('#r_' + name).val(), name);}
var makeRowStdSFT = function(name) { return makeRow($('#rVM_' + name).val(), ('"' + $('#r_' + name).val() + '"'), name);}

myStr += makeRowStd("granule_uid");
myStr += makeRowStd("granule_gid");
myStr += makeRowStd("obs_id") + cN;

myStr += makeRowStd("dataproduct_type");
myStr += makeRowStd("measurement_type") + cN;

myStr += makeRowStd("target_name");
myStr += makeRowStd("target_class") + cN;

myStr += makeRowStd("time_min");
myStr += makeRowStd("time_max");
myStr += makeRowStd("time_sampling_step");
myStr += makeRowStd("time_exp") + cN;

myStr += makeRowStd("spectral_range_min");
myStr += makeRowStd("spectral_range_max");
myStr += makeRowStd("spectral_sampling_step");
myStr += makeRowStd("spectral_resolution") + cN;

myStr += makeRowStd("c1min");
myStr += makeRowStd("c1max");
myStr += makeRowStd("c1_resol_min");
myStr += makeRowStd("c1_resol_max") + cN;

myStr += makeRowStd("c2min");
myStr += makeRowStd("c2max");
myStr += makeRowStd("c2_resol_min");
myStr += makeRowStd("c2_resol_max") + cN;

myStr += makeRowStd("c3min");
myStr += makeRowStd("c3max");
myStr += makeRowStd("c3_resol_min");
myStr += makeRowStd("c3_resol_max") + cN;

myStr += makeRowStdSFT("spatial_frame_type") + cN;

myStr += makeRowStd("incidence_min");
myStr += makeRowStd("incidence_max");
myStr += makeRowStd("emergence_min");
myStr += makeRowStd("emergence_max");
myStr += makeRowStd("phase_min");
myStr += makeRowStd("phase_max") + cN;

myStr += makeRowStd("instrument_host_name");
myStr += makeRowStd("instrument_name") + cN;

myStr += makeRowStd("processing_level") + cN;

myStr += makeRowStd("service_title");
myStr += makeRowStd("creation_date");
myStr += makeRowStd("modification_date");
myStr += makeRowStd("release_date") + cN;

myStr += makeRowStd("access_url");
myStr += makeRowStd("access_format");
myStr += makeRowStd("access_estsize");
myStr += makeRowStd("thumbnail_url");
myStr += makeRowStd("file_name") + cN;


/*
myStr += makeRowStd("");
myStr += makeRowStd("");
*/

//apply procDef:
myStr += cTT + cTT + '\<apply procDef=\"//epntap2#populate\" name=\"fillepn\"\>' + cN;

var procDefBind = function(name) { 
	if ($('#rVM_' + name).val() != "NUL") {
		return cTTT + cTT + '\<bind name=\"' + name + '\">@' + name + '\</bind\>' + cN;}
		else {return "";}
	}

myStr += procDefBind("granule_uid");
myStr += procDefBind("granule_gid");
myStr += procDefBind("obs_id") + cN;

myStr += procDefBind("dataproduct_type");
myStr += procDefBind("measurement_type") + cN;

myStr += procDefBind("target_name");
myStr += procDefBind("target_class") + cN;

myStr += procDefBind("time_min");
myStr += procDefBind("time_max");
myStr += procDefBind("time_sampling_step");
myStr += procDefBind("time_exp") + cN;

myStr += procDefBind("spectral_range_min");
myStr += procDefBind("spectral_range_max");
myStr += procDefBind("spectral_sampling_step");
myStr += procDefBind("spectral_resolution") + cN;

myStr += procDefBind("c1min");
myStr += procDefBind("c1max");
myStr += procDefBind("c1_resol_min");
myStr += procDefBind("c1_resol_max") + cN;

myStr += procDefBind("c2min");
myStr += procDefBind("c2max");
myStr += procDefBind("c2_resol_min");
myStr += procDefBind("c2_resol_max") + cN;

myStr += procDefBind("c3min");
myStr += procDefBind("c3max");
myStr += procDefBind("c3_resol_min");
myStr += procDefBind("c3_resol_max") + cN;

myStr += procDefBind("incidence_min");
myStr += procDefBind("incidence_max");
myStr += procDefBind("emergence_min");
myStr += procDefBind("emergence_max");
myStr += procDefBind("phase_min");
myStr += procDefBind("phase_max") + cN;

myStr += procDefBind("instrument_host_name");
myStr += procDefBind("instrument_name") + cN;

myStr += procDefBind("service_title");
myStr += procDefBind("creation_date");
myStr += procDefBind("modification_date");
myStr += procDefBind("release_date");

//close
myStr += cTT + cTT + '\</apply\>' + cN;
myStr += cTTT + '\</rowmaker\>' + cN;
myStr += cTT + '\</make\>' + cN;
myStr += cT + '\</data\>' + cN;
myStr += '\</resource\>' + cN;

// EXORT WRITEOUT:
 document.getElementById("output").innerText = myStr;
});
});
</script>
</body>
</html>

